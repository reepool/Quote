# Quote System

[![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://python.org)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Build Status](https://img.shields.io/badge/Build-Passing-brightgreen.svg)]())
[![Code Size](https://img.shields.io/badge/Code-25K+-lines-yellow.svg)]())
[![Files](https://img.shields.io/badge/Files-77+-purple.svg)]())

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„é‡‘èæ•°æ®ä¸‹è½½å’Œç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒå¤šæ•°æ®æºã€æ™ºèƒ½é™æµã€æ–­ç‚¹ç»­ä¼ ã€è‡ªåŠ¨è°ƒåº¦å’Œå®æ—¶ç›‘æ§ã€‚ç³»ç»Ÿé‡‡ç”¨ç°ä»£åŒ–çš„å¼‚æ­¥æ¶æ„ï¼Œæä¾›å®Œæ•´çš„RESTful APIå’ŒTelegramä»»åŠ¡ç®¡ç†ç•Œé¢ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ“Š å¤šæ•°æ®æºæ”¯æŒ
- **BaoStock** - ä¸­å›½Aè‚¡å¸‚åœºå†å²æ•°æ®ï¼ˆä¸»è¦æ•°æ®æºï¼‰
- **AkShare** - ç»¼åˆæ€§é‡‘èæ•°æ®æ¥å£
- **Tushare** - ä¸“ä¸šçº§é‡‘èæ•°æ®æœåŠ¡
- **YFinance** - é›…è™è´¢ç»æ•°æ®æ¥å£

### ğŸš€ æ™ºèƒ½ä¸‹è½½åŠŸèƒ½
- **ç²¾ç¡®ä¸‹è½½æ¨¡å¼** - åŸºäºä¸Šå¸‚æ—¥æœŸçš„æ™ºèƒ½æ•°æ®èŒƒå›´è®¡ç®—
- **æ–­ç‚¹ç»­ä¼ ** - æ”¯æŒä¸­æ–­åçš„è‡ªåŠ¨æ¢å¤
- **åˆ†å—ä¸‹è½½** - çµæ´»çš„åˆ†å—ç­–ç•¥ï¼Œæ”¯æŒ `download_chunk_days=0` ä¸€æ¬¡æ€§ä¸‹è½½
- **è´¨é‡è¯„ä¼°** - å®æ—¶æ•°æ®è´¨é‡è¯„åˆ†å’Œå®Œæ•´æ€§æ£€æŸ¥
- **çµæ´»æ—¥æœŸé€‰æ‹©** - æ”¯æŒå¹´ä»½èŒƒå›´å’Œç²¾ç¡®æ—¥æœŸèŒƒå›´ä¸‹è½½
- **è¿›åº¦è·Ÿè¸ª** - è¯¦ç»†çš„ä¸‹è½½è¿›åº¦ç›‘æ§å’Œç»Ÿè®¡ä¿¡æ¯

### ğŸ¤– æ™ºèƒ½ä»»åŠ¡ç®¡ç†
- **Telegramæœºå™¨äºº** - å®Œæ•´çš„ä»»åŠ¡ç®¡ç†ç•Œé¢
- **å®æ—¶çŠ¶æ€ç›‘æ§** - æ™ºèƒ½æ—¶é—´æ˜¾ç¤ºï¼Œæ”¯æŒç›¸å¯¹æ—¶é—´å’Œç»å¯¹æ—¶é—´
- **é…ç½®çƒ­é‡è½½** - è¿è¡Œæ—¶åŠ¨æ€æ›´æ–°ä»»åŠ¡é…ç½®æ— éœ€é‡å¯
- **ä»»åŠ¡æ§åˆ¶** - å¯ç”¨/ç¦ç”¨/æš‚åœ/æ¢å¤å®šæ—¶ä»»åŠ¡
- **æƒé™ç®¡ç†** - åŸºäºç”¨æˆ·IDçš„è®¿é—®æ§åˆ¶

### ğŸ›¡ï¸ é«˜çº§é™æµæœºåˆ¶
- **å¤šç»´åº¦é™æµ** - åˆ†é’Ÿ/å°æ—¶/æ—¥ä¸‰çº§æ™ºèƒ½é™æµ
- **è‡ªé€‚åº”æ§åˆ¶** - æ ¹æ®ç½‘ç»œçŠ¶å†µåŠ¨æ€è°ƒæ•´è¯·æ±‚é¢‘ç‡
- **é”™è¯¯æ¢å¤** - æ™ºèƒ½é‡è¯•å’Œæ•…éšœè‡ªæ„ˆæœºåˆ¶

### ğŸ“ˆ å®Œæ•´çš„ç”Ÿæ€ç³»ç»Ÿ
- **RESTful API** - å®Œæ•´çš„ HTTP API æœåŠ¡ï¼Œæ”¯æŒå¤šç§æ•°æ®æ ¼å¼
- **å®æ—¶ç›‘æ§** - ç³»ç»Ÿå¥åº·æ£€æŸ¥å’Œæ€§èƒ½ç›‘æ§
- **æ™ºèƒ½è°ƒåº¦** - å®Œå…¨é…ç½®åŒ–çš„ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿï¼Œæ”¯æŒ8ç§å†…ç½®ä»»åŠ¡
- **æ•°æ®åˆ†æ** - å†…ç½®æ•°æ®ç»Ÿè®¡å’Œåˆ†æåŠŸèƒ½
- **æ•°æ®ç¼ºå£æ£€æµ‹** - è‡ªåŠ¨è¯†åˆ«å’ŒæŠ¥å‘Šæ•°æ®ç¼ºå¤±ï¼Œæ”¯æŒæ™ºèƒ½ä¿®å¤
- **è‡ªåŠ¨å¤‡ä»½** - å®šæ—¶æ•°æ®åº“å¤‡ä»½å’Œæ¸…ç†ï¼Œæ”¯æŒTelegramé€šçŸ¥
- **æ™ºèƒ½æ—¶é—´å¤„ç†** - å¤šæ—¶åŒºæ”¯æŒå’Œäº¤æ˜“æ—¥å†é›†æˆ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd Quote

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å¤åˆ¶é…ç½®æ–‡ä»¶
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶é…ç½®å¿…è¦çš„å‚æ•°
```

### åŸºæœ¬ä½¿ç”¨

#### 1. ä¸‹è½½å†å²æ•°æ®

```bash
# ä¸‹è½½Aè‚¡å¸‚åœºæ•°æ®ï¼ˆé»˜è®¤æ‰€æœ‰å¹´ä»½ï¼‰
python3 main.py download --exchanges SSE SZSE

# ä¸‹è½½æŒ‡å®šå¹´ä»½çš„æ•°æ®
python3 main.py download --exchanges SSE SZSE --years 2023 2024

# ä¸‹è½½æŒ‡å®šæ—¥æœŸèŒƒå›´çš„æ•°æ®
python3 main.py download --exchanges SZSE --start-date 2024-01-01 --end-date 2024-12-31

# ä¸‹è½½ä»æŒ‡å®šæ—¥æœŸåˆ°ä»Šå¤©çš„æ•°æ®
python3 main.py download --exchanges SSE --start-date 2024-06-01

# ä¸‹è½½ä»å¼€å§‹åˆ°æŒ‡å®šæ—¥æœŸçš„æ•°æ®
python3 main.py download --exchanges SSE SZSE --end-date 2024-12-31

# ä½¿ç”¨å¸‚åœºé¢„è®¾
python3 main.py download --preset a_shares
python3 main.py download --preset hk_stocks
python3 main.py download --preset us_stocks

# æŒ‡å®šå•ä¸ªè‚¡ç¥¨ä¸‹è½½
python3 main.py download --instrument-id 000001.SZ

# ç»­ä¼ æ¨¡å¼ï¼ˆä¸­æ–­åç»§ç»­ä¸‹è½½ï¼Œé»˜è®¤å¯ç”¨ï¼‰
python3 main.py download --exchanges SSE SZSE --resume

# é‡ç½®è¿›åº¦é‡æ–°ä¸‹è½½
python3 main.py download --exchanges SZSE --no-resume

# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„å¸‚åœºé¢„è®¾
python3 main.py download --list-presets
```

#### 2. æ•°æ®æ›´æ–°å’Œç»´æŠ¤

```bash
# æ›´æ–°æ—¥çº¿æ•°æ®
python3 main.py update --exchanges SSE SZSE

# æ•°æ®ç¼ºå£æ£€æµ‹
python3 main.py gap --exchanges SSE SZSE --start-date 2024-01-01 --end-date 2024-12-31

# äº¤äº’å¼ä¸‹è½½æ¨¡å¼
python3 main.py interactive --mode both
```

#### 3. å¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨APIæœåŠ¡å™¨
python3 main.py api --host 0.0.0.0 --port 8000

# å¯åŠ¨è°ƒåº¦å™¨ï¼ˆä»…å®šæ—¶ä»»åŠ¡ï¼‰
python3 main.py scheduler

# å¯åŠ¨å®Œæ•´ç³»ç»Ÿï¼ˆè°ƒåº¦å™¨ + APIæœåŠ¡ï¼‰
python3 main.py full --host 0.0.0.0 --port 8000
```

#### 4. Telegramä»»åŠ¡ç®¡ç†

ç³»ç»Ÿæä¾›å®Œæ•´çš„Telegramæœºå™¨äººç®¡ç†ç•Œé¢ï¼š

```bash
# å¯åŠ¨åŒ…å«ä»»åŠ¡ç®¡ç†å™¨çš„å®Œæ•´ç³»ç»Ÿ
python3 main.py full --host 0.0.0.0 --port 8000

# æˆ–åˆ†åˆ«å¯åŠ¨è°ƒåº¦å™¨å’ŒAPIæœåŠ¡
python3 main.py scheduler
python3 main.py api --host 0.0.0.0 --port 8000
```

**Telegramæœºå™¨äººå‘½ä»¤**ï¼š
```
/start           # æ˜¾ç¤ºä¸»èœå•å’Œå¸®åŠ©ä¿¡æ¯
/status          # æŸ¥çœ‹æ‰€æœ‰ä»»åŠ¡çŠ¶æ€å’Œä¸‹æ¬¡æ‰§è¡Œæ—¶é—´
/detail <ä»»åŠ¡ID>  # æŸ¥çœ‹æŒ‡å®šä»»åŠ¡çš„è¯¦ç»†ä¿¡æ¯
/reload_config   # çƒ­é‡è½½é…ç½®æ–‡ä»¶
/help            # æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
```

**ä»»åŠ¡æ§åˆ¶ç¤ºä¾‹**ï¼š
```bash
# åœ¨Telegramä¸­ç›´æ¥å‘é€å‘½ä»¤
/status                    # æ˜¾ç¤ºä»»åŠ¡çŠ¶æ€ï¼ˆæ™ºèƒ½æ—¶é—´æ˜¾ç¤ºï¼‰
/detail daily_data_update  # æŸ¥çœ‹æ¯æ—¥æ•°æ®æ›´æ–°ä»»åŠ¡è¯¦æƒ…
/reload_config            # é‡è½½ä»»åŠ¡é…ç½®
```

#### 5. ç³»ç»Ÿç®¡ç†

```bash
# æ˜¾ç¤ºç³»ç»ŸçŠ¶æ€
python3 main.py status

# è¿è¡ŒæŒ‡å®šä»»åŠ¡
python3 main.py job --job-id daily_data_update
python3 main.py job --job-id monthly_data_integrity_check
python3 main.py job --job-id database_backup
```

## ğŸ“– è¯¦ç»†åŠŸèƒ½è¯´æ˜

### è°ƒåº¦ç³»ç»Ÿ

ç³»ç»Ÿå†…ç½®äº†ä¸°å¯Œçš„å®šæ—¶ä»»åŠ¡ï¼Œæ”¯æŒå®Œå…¨é…ç½®åŒ–ç®¡ç†ï¼š

#### æ ¸å¿ƒè°ƒåº¦ä»»åŠ¡

1. **æ¯æ—¥æ•°æ®æ›´æ–°** (`daily_data_update`)
   - **æ‰§è¡Œæ—¶é—´**: æ¯å‘¨ä¸€è‡³å‘¨äº” 20:00
   - **åŠŸèƒ½**: è‡ªåŠ¨æ›´æ–°å½“æ—¥è‚¡ç¥¨æ•°æ®
   - **ç‰¹ç‚¹**: æ”¯æŒäº¤æ˜“æ—¥æ£€æŸ¥ã€å¸‚åœºæ”¶ç›˜ç­‰å¾…

2. **ç³»ç»Ÿå¥åº·æ£€æŸ¥** (`system_health_check`)
   - **æ‰§è¡Œæ—¶é—´**: æ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡
   - **åŠŸèƒ½**: æ£€æŸ¥æ•°æ®æºçŠ¶æ€ã€æ•°æ®åº“å¥åº·ã€ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ
   - **ç‰¹ç‚¹**: è‡ªåŠ¨å‘Šè­¦ã€æ€§èƒ½ç›‘æ§

3. **æ¯å‘¨æ•°æ®ç»´æŠ¤** (`weekly_data_maintenance`)
   - **æ‰§è¡Œæ—¶é—´**: æ¯å‘¨æ—¥ 02:00
   - **åŠŸèƒ½**: æ•°æ®åº“ä¼˜åŒ–ã€æ—¥å¿—æ¸…ç†ã€å¤‡ä»½éªŒè¯
   - **åŒ…å«**: æ•°æ®åº“å¤‡ä»½ã€æ—¥å¿—æ¸…ç†ã€æ•°æ®åº“ä¼˜åŒ–ã€æ•°æ®å®Œæ•´æ€§éªŒè¯

4. **æœˆåº¦æ•°æ®å®Œæ•´æ€§æ£€æŸ¥** (`monthly_data_integrity_check`)
   - **æ‰§è¡Œæ—¶é—´**: æ¯æœˆ1æ—¥ 03:00
   - **åŠŸèƒ½**: æ£€æŸ¥ä¸Šæœˆæ•°æ®ç¼ºå£å¹¶è‡ªåŠ¨ä¿®å¤
   - **ç‰¹ç‚¹**: æ™ºèƒ½ç¼ºå£æ£€æµ‹ã€ä¼˜å…ˆçº§ä¿®å¤ã€è¯¦ç»†æŠ¥å‘Š

5. **å­£åº¦æ•°æ®æ¸…ç†** (`quarterly_cleanup`)
   - **æ‰§è¡Œæ—¶é—´**: æ¯å­£åº¦æœ€åä¸€å¤© 04:00
   - **åŠŸèƒ½**: æ¸…ç†è¿‡æœŸæ•°æ®å’Œæ–‡ä»¶
   - **åŒ…å«**: æ—§è¡Œæƒ…æ•°æ®æ¸…ç†ã€ä¸´æ—¶æ–‡ä»¶æ¸…ç†

6. **æ•°æ®åº“å¤‡ä»½** (`database_backup`) â­ **é‡è¦åŠŸèƒ½**
   - **æ‰§è¡Œæ—¶é—´**: æ¯å‘¨å…­ 06:00
   - **åŠŸèƒ½**: è‡ªåŠ¨å¤‡ä»½æ•°æ®åº“æ–‡ä»¶
   - **ç‰¹ç‚¹**: æ”¯æŒTelegramé€šçŸ¥ã€è‡ªåŠ¨æ¸…ç†è¿‡æœŸå¤‡ä»½

7. **ç¼“å­˜é¢„çƒ­** (`cache_warm_up`)
   - **æ‰§è¡Œæ—¶é—´**: æ¯æ—¥ 08:00
   - **åŠŸèƒ½**: é¢„åŠ è½½çƒ­é—¨æ•°æ®åˆ°ç¼“å­˜
   - **åŒ…å«**: çƒ­é—¨è‚¡ç¥¨ã€å¸‚åœºæŒ‡æ•°é¢„çƒ­

8. **äº¤æ˜“æ—¥å†æ›´æ–°** (`trading_calendar_update`)
   - **æ‰§è¡Œæ—¶é—´**: æ¯æœˆ1æ—¥ 01:00
   - **åŠŸèƒ½**: æ›´æ–°å„äº¤æ˜“æ‰€äº¤æ˜“æ—¥å†
   - **ç‰¹ç‚¹**: æ”¯æŒèŠ‚å‡æ—¥éªŒè¯

#### Telegramä»»åŠ¡ç®¡ç†ç•Œé¢ â­ **æ ¸å¿ƒåŠŸèƒ½**

ç³»ç»Ÿæä¾›å®Œæ•´çš„Telegramæœºå™¨äººç•Œé¢è¿›è¡Œä»»åŠ¡ç®¡ç†ï¼š

**æ™ºèƒ½æ—¶é—´æ˜¾ç¤º**ï¼š
- 1å°æ—¶å†… â†’ "Xåˆ†é’Ÿå"
- 24å°æ—¶å†… â†’ "ä»Šå¤© HH:MM"
- 7å¤©å†… â†’ "å‘¨ä¸€ HH:MM"
- è¶…è¿‡7å¤© â†’ "MM-DD HH:MM"

**å®æ—¶ä»»åŠ¡æ§åˆ¶**ï¼š
- æŸ¥çœ‹æ‰€æœ‰ä»»åŠ¡çŠ¶æ€å’Œä¸‹æ¬¡æ‰§è¡Œæ—¶é—´
- ç«‹å³æ‰§è¡ŒæŒ‡å®šä»»åŠ¡
- å¯ç”¨/ç¦ç”¨/æš‚åœä»»åŠ¡
- é…ç½®çƒ­é‡è½½æ— éœ€é‡å¯

### ä¸‹è½½æ¨¡å¼

#### ç²¾ç¡®ä¸‹è½½æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
- åŸºäºæ¯åªè‚¡ç¥¨çš„å®é™…ä¸Šå¸‚æ—¥æœŸè®¡ç®—ä¸‹è½½èŒƒå›´
- è‡ªåŠ¨è¿‡æ»¤æœªä¸Šå¸‚æœŸé—´çš„æ•°æ®è¯·æ±‚
- é¿å…æ— æ•ˆè¯·æ±‚ï¼Œæé«˜ä¸‹è½½æ•ˆç‡

#### æ—¥æœŸèŒƒå›´ä¸‹è½½
- **çµæ´»æŒ‡å®š**ï¼šæ”¯æŒç²¾ç¡®çš„å¼€å§‹æ—¥æœŸå’Œç»“æŸæ—¥æœŸ
- **éƒ¨åˆ†èŒƒå›´**ï¼šå¯ä»¥åªæŒ‡å®šå¼€å§‹æ—¥æœŸï¼ˆåˆ°ä»Šå¤©ï¼‰æˆ–ç»“æŸæ—¥æœŸï¼ˆä»å¼€å§‹ï¼‰
- **æ ¼å¼æ ‡å‡†**ï¼šä½¿ç”¨æ ‡å‡†çš„ `YYYY-MM-DD` æ—¥æœŸæ ¼å¼
- **ä¼˜å…ˆçº§**ï¼šç›´æ¥æŒ‡å®šçš„æ—¥æœŸèŒƒå›´ä¼˜å…ˆäºå¹´ä»½å‚æ•°

#### åˆ†å—ä¸‹è½½ç­–ç•¥
```python
# é…ç½®æ–‡ä»¶ä¸­çš„åˆ†å—è®¾ç½®
{
  "data_config": {
    "download_chunk_days": 2000,  # æ¯2000å¤©ä¸€ä¸ªå—
    "batch_size": 50               # æ¯æ‰¹å¤„ç†50åªè‚¡ç¥¨
  }
}
```

#### ä¸€æ¬¡æ€§ä¸‹è½½æ¨¡å¼
```bash
# è®¾ç½® download_chunk_days=0 å®ç°ä¸€æ¬¡æ€§ä¸‹è½½
# æˆ–é€šè¿‡é…ç½®æ–‡ä»¶è®¾ç½®
```

### å¸‚åœºé¢„è®¾

ç³»ç»Ÿæä¾›äº†å¤šä¸ªå¸‚åœºé¢„è®¾ç»„åˆï¼Œæ–¹ä¾¿å¿«é€Ÿé€‰æ‹©ï¼š

- **a_shares**: ä¸­å›½Aè‚¡å¸‚åœº (SSE, SZSE, BSE)
- **hk_stocks**: é¦™æ¸¯è‚¡å¸‚ (HKEX)
- **us_stocks**: ç¾å›½è‚¡å¸‚ (NASDAQ, NYSE)
- **mainland**: ä¸­å›½å¤§é™†å¸‚åœº (SSE, SZSE, BSE)
- **overseas**: æµ·å¤–å¸‚åœº (HKEX, NASDAQ, NYSE)
- **chinese**: ä¸­æ–‡å¸‚åœº (åŒ…å«æ¸¯è‚¡) (SSE, SZSE, BSE, HKEX)
- **global**: å…¨çƒå¸‚åœº (NASDAQ, NYSE)

### API æ¥å£ â­ ç°ä»£å¼‚æ­¥API

#### ç³»ç»Ÿç®¡ç†
```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:8000/health

# ç³»ç»ŸçŠ¶æ€
curl http://localhost:8000/system/status

# ç³»ç»Ÿç»Ÿè®¡
curl http://localhost:8000/stats
```

#### äº¤æ˜“å“ç§ç®¡ç†
```bash
# è·å–äº¤æ˜“å“ç§åˆ—è¡¨ï¼ˆæ”¯æŒè¿‡æ»¤ï¼‰
curl "http://localhost:8000/instruments?exchange=SSE&limit=100"

# æ ¹æ®IDè·å–å“ç§ä¿¡æ¯
curl http://localhost:8000/instruments/000001.SZSE

# æ ¹æ®ä»£ç è·å–å“ç§ä¿¡æ¯
curl http://localhost:8000/instruments/symbol/000001
```

#### è¡Œæƒ…æ•°æ®æ¥å£
```bash
# è·å–æ—¥çº¿æ•°æ®ï¼ˆæ”¯æŒå¤šç§æ ¼å¼ï¼‰
curl "http://localhost:8000/quotes/daily?symbol=000001.SZSE&start_date=2024-01-01&format=json"

# è·å–æœ€æ–°è¡Œæƒ…æ•°æ®
curl "http://localhost:8000/quotes/latest?symbols=000001.SZSE,600000.SSE"

# æ‰¹é‡è·å–æ•°æ®
curl -X POST http://localhost:8000/data/download/historical \
  -H "Content-Type: application/json" \
  -d '{"exchanges": ["SSE", "SZSE"], "years": [2024]}'
```

#### æ•°æ®ç¼ºå£ç®¡ç†
```bash
# è·å–æ•°æ®ç¼ºå£
curl "http://localhost:8000/gaps?exchange=SSE&start_date=2024-01-01"

# å¡«è¡¥æ•°æ®ç¼ºå£
curl -X POST http://localhost:8000/gaps/fill \
  -H "Content-Type: application/json" \
  -d '{"exchange": "SSE", "start_date": "2024-01-01", "auto_fix": true}'

# æ•°æ®è´¨é‡æŠ¥å‘Š
curl "http://localhost:8000/gaps/report?detailed=true"
```

#### äº¤æ˜“æ—¥å†æ¥å£
```bash
# è·å–äº¤æ˜“æ—¥å†
curl "http://localhost:8000/calendar/trading?exchange=SSE&year=2024"

# è·å–ä¸‹ä¸€ä¸ªäº¤æ˜“æ—¥
curl http://localhost:8000/calendar/trading/next?exchange=SSE

# è·å–ä¸Šä¸€ä¸ªäº¤æ˜“æ—¥
curl http://localhost:8000/calendar/trading/previous?exchange=SSE
```

### æ•°æ®ç¼ºå£æ£€æµ‹

ç³»ç»Ÿèƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹æ•°æ®ç¼ºå£ï¼š

```bash
# åŸºç¡€ç¼ºå£æ£€æµ‹
python3 main.py gap --exchanges SSE SZSE

# æŒ‡å®šæ—¶é—´èŒƒå›´å’Œä¸¥é‡ç¨‹åº¦
python3 main.py gap --exchanges SSE --start-date 2024-01-01 --severity high

# ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š
python3 main.py gap --exchanges SZSE --output gap_report.json --detailed
```

### å¤‡ä»½ç³»ç»Ÿ

#### è‡ªåŠ¨å¤‡ä»½é…ç½®
```json
{
  "backup_config": {
    "enabled": true,
    "source_db_path": "data/quotes.db",
    "backup_directory": "data/PVE-Bak/QuoteBak",
    "retention_days": 30,
    "notification_enabled": true,
    "filename_pattern": "quotes_backup_{timestamp}.db",
    "max_backup_files": 10
  }
}
```

#### æ‰‹åŠ¨å¤‡ä»½
```bash
# è¿è¡Œå¤‡ä»½ä»»åŠ¡
python3 main.py job --job-id database_backup
```

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

```
Quote/
â”œâ”€â”€ main.py                    # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ data_manager.py            # æ•°æ®ç®¡ç†æ ¸å¿ƒ
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ config.json            # ä¸»é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ config-template.json   # é…ç½®æ¨¡æ¿
â”œâ”€â”€ requirements.txt           # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ data_sources/              # æ•°æ®æºæ¨¡å—
â”‚   â”œâ”€â”€ base_source.py         # æ•°æ®æºåŸºç±»
â”‚   â”œâ”€â”€ baostock_source.py     # BaoStockæ•°æ®æº
â”‚   â”œâ”€â”€ akshare_source.py      # AkShareæ•°æ®æº
â”‚   â”œâ”€â”€ tushare_source.py      # Tushareæ•°æ®æº
â”‚   â”œâ”€â”€ yfinance_source.py     # YFinanceæ•°æ®æº
â”‚   â””â”€â”€ source_factory.py      # æ•°æ®æºå·¥å‚
â”œâ”€â”€ database/                  # æ•°æ®åº“æ¨¡å—
â”‚   â”œâ”€â”€ models.py              # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ operations.py          # æ•°æ®åº“æ“ä½œ
â”‚   â””â”€â”€ connection.py          # æ•°æ®åº“è¿æ¥
â”œâ”€â”€ api/                       # APIæœåŠ¡
â”‚   â”œâ”€â”€ app.py                 # FastAPIåº”ç”¨
â”‚   â”œâ”€â”€ routes.py              # APIè·¯ç”±
â”‚   â”œâ”€â”€ models.py              # APIæ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ middleware.py          # ä¸­é—´ä»¶
â”œâ”€â”€ scheduler/                 # ä»»åŠ¡è°ƒåº¦
â”‚   â”œâ”€â”€ scheduler.py           # è°ƒåº¦å™¨æ ¸å¿ƒ
â”‚   â”œâ”€â”€ tasks.py               # ä»»åŠ¡å®šä¹‰
â”‚   â”œâ”€â”€ job_config.py          # ä»»åŠ¡é…ç½®ç®¡ç†
â”‚   â””â”€â”€ monitor.py             # è°ƒåº¦å™¨ç›‘æ§
â”œâ”€â”€ utils/                     # å·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ date_utils.py          # æ—¥æœŸæ—¶é—´å·¥å…· â­
â”‚   â”œâ”€â”€ task_manager/          # Telegramä»»åŠ¡ç®¡ç†å™¨ â­
â”‚   â”‚   â”œâ”€â”€ task_manager.py     # ä¸»æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ handlers.py         # æ¶ˆæ¯å¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ models.py           # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ formatters.py      # æ¶ˆæ¯æ ¼å¼åŒ–
â”‚   â”‚   â””â”€â”€ keyboards.py        # é”®ç›˜å¸ƒå±€
â”‚   â”œâ”€â”€ logging_manager.py     # æ—¥å¿—ç®¡ç†
â”‚   â”œâ”€â”€ security_utils.py      # å®‰å…¨å·¥å…·
â”‚   â”œâ”€â”€ cache.py               # ç¼“å­˜ç®¡ç†
â”‚   â”œâ”€â”€ validation.py          # æ•°æ®éªŒè¯
â”‚   â””â”€â”€ config_manager.py      # é…ç½®ç®¡ç†
â”œâ”€â”€ data/                      # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ quotes.db              # ä¸»æ•°æ®åº“
â”‚   â””â”€â”€ PVE-Bak/               # å¤‡ä»½ç›®å½•
â”œâ”€â”€ log/                       # æ—¥å¿—ç›®å½•
â””â”€â”€ tests/                     # æµ‹è¯•ç”¨ä¾‹
```

### æ ¸å¿ƒæ¨¡å—è¯´æ˜

- **â­ utils/date_utils.py**: æ™ºèƒ½æ—¶é—´å¤„ç†å’Œæ—¶åŒºç®¡ç†
- **â­ utils/task_manager/**: Telegramæœºå™¨äººä»»åŠ¡ç®¡ç†ç³»ç»Ÿ
- **scheduler/**: å®Œå…¨é…ç½®åŒ–çš„ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ
- **api/**: ç°ä»£å¼‚æ­¥RESTful APIæœåŠ¡
- **data_sources/**: å¤šæ•°æ®æºç»Ÿä¸€æ¥å£å’Œå·¥å‚æ¨¡å¼
- **database/**: ç°ä»£SQLAlchemy 2.0 ORMæ“ä½œ

## ğŸ”§ é«˜çº§é…ç½®

### æ•°æ®æºé…ç½®

#### BaoStock é…ç½®ï¼ˆä¸»è¦æ•°æ®æºï¼‰
```json
{
  "data_sources_config": {
    "baostock": {
      "enabled": true,
      "exchanges_supported": ["a_stock"],
      "primary_source_of": ["a_stock"],
      "max_requests_per_minute": 60,
      "max_requests_per_hour": 3000,
      "max_requests_per_day": 60000,
      "retry_times": 5,
      "retry_interval": 5.0
    }
  }
}
```

#### é™æµé…ç½®
```json
{
  "rate_limit_config": {
    "max_requests_per_minute": 60,
    "max_requests_per_hour": 1000,
    "max_requests_per_day": 10000,
    "retry_times": 3,
    "retry_interval": 1.0
  }
}
```

### è°ƒåº¦å™¨é…ç½®

```json
{
  "scheduler_config": {
    "enabled": true,
    "timezone": "Asia/Shanghai",
    "max_instances": 1,
    "misfire_grace_time": 300,
    "coalesce": true
  }
}
```

### Telegram é€šçŸ¥å’Œä»»åŠ¡ç®¡ç†é…ç½®

```json
{
  "telegram_config": {
    "enabled": true,
    "api_id": "your_api_id",
    "api_hash": "your_api_hash",
    "bot_token": "your_bot_token",
    "chat_id": ["your_chat_id"],
    "session_name": "MsgBot",
    "connection_retries": 3,
    "retry_delay": 5,
    "auto_reconnect": true,
    "timeout": 30,
    "intervals": {
      "tg_msg_retry_interval": 3,
      "tg_msg_retry_times": 5,
      "tg_connect_timeout": 30,
      "tg_auto_reconnect": true,
      "tg_max_reconnect_attempts": 5,
      "tg_reconnect_delay": 10
    }
  }
}
```

**åŠŸèƒ½è¯´æ˜**ï¼š
- **ä»»åŠ¡ç®¡ç†**: æ”¯æŒå®Œæ•´çš„ä»»åŠ¡æ§åˆ¶åŠŸèƒ½
- **æƒé™æ§åˆ¶**: åŸºäºchat_idçš„è®¿é—®æ§åˆ¶
- **ä¼šè¯ç®¡ç†**: è‡ªåŠ¨é‡è¿å’Œé”™è¯¯æ¢å¤
- **æ¶ˆæ¯é‡è¯•**: æ™ºèƒ½æ¶ˆæ¯å‘é€é‡è¯•æœºåˆ¶

## ğŸ“Š æ”¯æŒçš„äº¤æ˜“æ‰€å’Œæ•°æ®ç±»å‹

### äº¤æ˜“æ‰€æ”¯æŒ
- **SSE** - ä¸Šæµ·è¯åˆ¸äº¤æ˜“æ‰€
- **SZSE** - æ·±åœ³è¯åˆ¸äº¤æ˜“æ‰€
- **BSE** - åŒ—äº¬è¯åˆ¸äº¤æ˜“æ‰€
- **HKEX** - é¦™æ¸¯äº¤æ˜“æ‰€
- **NASDAQ** - çº³æ–¯è¾¾å…‹
- **NYSE** - çº½çº¦è¯åˆ¸äº¤æ˜“æ‰€

### æ•°æ®ç±»å‹
- **æ—¥çº¿æ•°æ®** - OHLCVæ•°æ®
- **å¤æƒæ•°æ®** - å‰å¤æƒ/åå¤æƒ
- **åŸºæœ¬é¢æ•°æ®** - è‚¡ç¥¨åŸºæœ¬ä¿¡æ¯
- **äº¤æ˜“æ—¥å†** - äº¤æ˜“æ—¥/éäº¤æ˜“æ—¥

### æ•°æ®è´¨é‡
- **å®æ—¶è¯„åˆ†** - æ¯æ¡æ•°æ®éƒ½æœ‰è´¨é‡è¯„åˆ†
- **å®Œæ•´æ€§æ£€æŸ¥** - æ•°æ®å®Œæ•´æ€§éªŒè¯
- **å¼‚å¸¸æ£€æµ‹** - è‡ªåŠ¨æ£€æµ‹å¼‚å¸¸æ•°æ®
- **ç¼ºå£è¯†åˆ«** - æ™ºèƒ½è¯†åˆ«æ•°æ®ç¼ºå¤±

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. ä¸‹è½½å¡ä½æˆ–ä¸­æ–­
```bash
# æ£€æŸ¥ä¸‹è½½çŠ¶æ€
python3 main.py status

# æ£€æŸ¥æ•°æ®ç¼ºå£
python3 main.py gap --exchanges SSE SZSE

# ç»§ç»­ä¸‹è½½ï¼ˆç»­ä¼ æ¨¡å¼ï¼‰
python3 main.py download --exchanges SSE SZSE --resume
```

#### 2. æ•°æ®æºå¼‚å¸¸
```bash
# æ£€æŸ¥æ•°æ®æºçŠ¶æ€
curl http://localhost:8000/health

# æŸ¥çœ‹æ•°æ®æºæ—¥å¿—
grep "DataSource" log/sys.log
```

#### 3. è°ƒåº¦å™¨é—®é¢˜
```bash
# æ£€æŸ¥è°ƒåº¦å™¨çŠ¶æ€
python3 main.py job --job-id system_health_check

# é‡å¯è°ƒåº¦å™¨
python3 main.py scheduler
```

#### 4. æ•°æ®åº“é—®é¢˜
```bash
# æ£€æŸ¥æ•°æ®åº“çŠ¶æ€
python3 main.py status

# æ‰‹åŠ¨å¤‡ä»½æ•°æ®åº“
python3 main.py job --job-id database_backup

# æ•°æ®åº“ä¼˜åŒ–
python3 main.py job --job-id weekly_data_maintenance
```

### æ—¥å¿—ç®¡ç†

```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
tail -f log/sys.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
grep "ERROR" log/sys.log

# æŸ¥çœ‹è°ƒåº¦å™¨æ—¥å¿—
grep "Scheduler" log/sys.log
```

## ğŸ“š æ›´æ–°æ—¥å¿—

### v2.3.0 (2025-10-18) â­ **é‡å¤§æ›´æ–°**
- âœ¨ **Telegramä»»åŠ¡ç®¡ç†ç³»ç»Ÿ**
  - å®Œæ•´çš„Telegramæœºå™¨äººç•Œé¢
  - æ™ºèƒ½æ—¶é—´æ˜¾ç¤ºï¼ˆç›¸å¯¹æ—¶é—´ + ç»å¯¹æ—¶é—´ï¼‰
  - ä»»åŠ¡å®æ—¶æ§åˆ¶ï¼ˆå¯ç”¨/ç¦ç”¨/æš‚åœ/æ¢å¤ï¼‰
  - é…ç½®çƒ­é‡è½½åŠŸèƒ½
  - æƒé™ç®¡ç†å’Œè®¿é—®æ§åˆ¶

- ğŸ¯ **æ—¶é—´å¤„ç†ä¼˜åŒ–**
  - æ–°å¢ `utils/date_utils.py` æ™ºèƒ½æ—¶é—´æ ¼å¼åŒ–
  - å¤šæ—¶åŒºæ”¯æŒï¼ˆAè‚¡ã€æ¸¯è‚¡ã€ç¾è‚¡ï¼‰
  - æ™ºèƒ½æ—¶é—´æ˜¾ç¤ºç­–ç•¥
  - äº¤æ˜“æ—¥å†æ·±åº¦é›†æˆ

- ğŸš€ **è°ƒåº¦å™¨å¢å¼º**
  - å®Œå…¨é…ç½®åŒ–çš„ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ
  - 8ç§å†…ç½®å®šæ—¶ä»»åŠ¡
  - è¿è¡Œæ—¶ä»»åŠ¡çŠ¶æ€ç®¡ç†
  - ä»»åŠ¡æ‰§è¡Œå†å²è®°å½•

- ğŸ› ï¸ **æ¶æ„ä¼˜åŒ–**
  - æ¨¡å—åŒ–è®¾è®¡æ”¹è¿›
  - å¼‚æ­¥æ€§èƒ½æå‡
  - é”™è¯¯å¤„ç†æœºåˆ¶å®Œå–„
  - ä»£ç è´¨é‡æå‡ï¼ˆ25K+ è¡Œä»£ç ï¼Œ77ä¸ªæ–‡ä»¶ï¼‰

### v2.2.0 (2025-10-14)
- âœ¨ **æ–°å¢åŠŸèƒ½**
  - æ•°æ®åº“è‡ªåŠ¨å¤‡ä»½ä»»åŠ¡ (`database_backup`)
  - å®Œæ•´çš„å¤‡ä»½é…ç½®ç®¡ç†
  - Telegram é€šçŸ¥é›†æˆ
  - æ™ºèƒ½å¤‡ä»½æ–‡ä»¶æ¸…ç†
  - æ•°æ®ç¼ºå£æ£€æµ‹åŠŸèƒ½
  - äº¤äº’å¼ä¸‹è½½æ¨¡å¼
  - å¸‚åœºé¢„è®¾ç»„åˆ

- ğŸ¯ **æ ¸å¿ƒæ”¹è¿›**
  - ç»Ÿä¸€çš„é…ç½®ç®¡ç†æœºåˆ¶
  - å¢å¼ºçš„è°ƒåº¦å™¨ä»»åŠ¡ç³»ç»Ÿ
  - æ”¹è¿›çš„é”™è¯¯å¤„ç†å’Œé€šçŸ¥
  - ä¼˜åŒ–çš„æ•°æ®åº“æ“ä½œ

### v2.1.0 (2024-10-11)
- âœ¨ **æ–°å¢åŠŸèƒ½**
  - æŒ‡å®šæ—¥æœŸèŒƒå›´ä¸‹è½½
  - æ™ºèƒ½äº¤æ˜“æ—¥å†é€‰æ‹©ç­–ç•¥
  - çµæ´»çš„ç»­ä¼ é€»è¾‘ä¼˜åŒ–

- ğŸ¯ **æ ¸å¿ƒæ”¹è¿›**
  - æ ¹æ®ä¸‹è½½åœºæ™¯é€‰æ‹©åˆé€‚çš„äº¤æ˜“æ—¥å†è·å–æ–¹å¼
  - ä¿®å¤ç»­ä¼ é€»è¾‘ä¸­çš„æ‰¹æ¬¡è®¡ç®—é”™è¯¯
  - ä¼˜åŒ–äº¤æ˜“æ—¥åˆ¤æ–­ï¼Œä¼˜å…ˆä½¿ç”¨äº¤æ˜“æ—¥å†è¡¨

### v2.0.0 (2024-10-10)
- ğŸ‰ ç»Ÿä¸€äº† BaoStock å’Œ AkShare çš„é™æµæœºåˆ¶
- ğŸ—‘ï¸ ç§»é™¤äº†å†—ä½™çš„ `_download_exchange_continuous` æ–¹æ³•
- ğŸ“ˆ ä¼˜åŒ–äº†æ•°æ®åº“ç»“æ„ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½
- ğŸ›¡ï¸ å¢å¼ºäº†é”™è¯¯æ¢å¤å’Œè‡ªåŠ¨é‡è¯•æœºåˆ¶
- ğŸ“Š æ·»åŠ äº†æ•°æ®è´¨é‡è¯„åˆ†ç³»ç»Ÿ
- ğŸš€ æ”¯æŒä¸€æ¬¡æ€§ä¸‹è½½æ¨¡å¼ (`download_chunk_days=0`)

### v1.0.0 (2024-09-01)
- ğŸ¯ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- ğŸ“Š æ”¯æŒå¤šæ•°æ®æºä¸‹è½½
- ğŸ”§ å®ç°æ–­ç‚¹ç»­ä¼ åŠŸèƒ½
- ğŸŒ æä¾›RESTful APIæœåŠ¡

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

### å¼€å‘ç¯å¢ƒè®¾ç½®

```bash
# è®¾ç½®å¼€å‘ç¯å¢ƒ
pip install -r requirements.txt

# è¿è¡Œæµ‹è¯•
python3 -m pytest tests/

# ä»£ç æ ¼å¼åŒ–
black .
isort .
```

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- [BaoStock](http://baostock.com) - æä¾›å…è´¹çš„ä¸­å›½è‚¡å¸‚å†å²æ•°æ®
- [AkShare](https://github.com/akshare/akshare) - å¼€æºé‡‘èæ•°æ®æ¥å£
- [Tushare](https://tushare.pro) - ä¸“ä¸šé‡‘èæ•°æ®æœåŠ¡å¹³å°
- [YFinance](https://github.com/ranaroussi/yfinance) - é›…è™è´¢ç»æ•°æ®æ¥å£

## ğŸ“ è”ç³»æ–¹å¼

- é¡¹ç›®ä¸»é¡µï¼š[GitHub Repository](https://github.com/your-username/Quote)
- é—®é¢˜åé¦ˆï¼š[Issues](https://github.com/your-username/Quote/issues)
- åŠŸèƒ½å»ºè®®ï¼š[Discussions](https://github.com/your-username/Quote/discussions)

---

**Quote System** - è®©é‡‘èæ•°æ®ç®¡ç†å˜å¾—ç®€å•é«˜æ•ˆï¼ ğŸš€

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [æ•°æ®åº“å¤‡ä»½å®æ–½æ–‡æ¡£](DATABASE_BACKUP_IMPLEMENTATION.md)
- [API æ¥å£æ–‡æ¡£](docs/api/restful_api.md)
- [é…ç½®æ–‡ä»¶è¯¦è§£](docs/configuration/config_file.md)
- [æ•…éšœæ’é™¤æŒ‡å—](docs/troubleshooting/faq.md)